package org.example.jsonrpc.excel;

import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.*;
import java.util.Base64;

public class ExcelReaderFromBase64 {

    public static void main(String[] args) {
        // 1️⃣ Base64 Excel string (seni "UEsDB..." boshlangan stringingni shu yerga joylashtir)
        String base64Excel = "UEsDBBQACAgIABVlZVsAAAAAAAAAAAAAAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbLVTy27CMBD8lcj" +
                "XKjb0UFUVgUMfxxap9ANce5NY+CWvofD3XQc4lFKJCnHyY2ZnZlf2ZLZxtlpDQhN8w8Z8xCrwKmjju4Z9LF7qe1Zhll5LGzw0zAc2" +
                "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" +
                "AAAB9DAAAeGwvd29ya3NoZWV0cy9zaGVldDEueG1sUEsFBgAAAAAJAAkAPwIAAOQTAAAAAA==";

        try {
            // 2️⃣ Base64 ni byte[] ga aylantiramiz
            byte[] excelBytes = Base64.getDecoder().decode(base64Excel);

            // 3️⃣ Fayl sifatida saqlaymiz (ixtiyoriy)
            FileOutputStream fos = new FileOutputStream("decoded.xlsx");
            fos.write(excelBytes);
            fos.close();

            // 4️⃣ Apache POI orqali Excelni o‘qiymiz
            try (InputStream inputStream = new ByteArrayInputStream(excelBytes);
                 Workbook workbook = new XSSFWorkbook(inputStream)) {

                Sheet sheet = workbook.getSheetAt(0); // birinchi sheet
                for (Row row : sheet) {
                    for (Cell cell : row) {
                        switch (cell.getCellType()) {
                            case STRING -> System.out.print(cell.getStringCellValue() + "\t");
                            case NUMERIC -> System.out.print(cell.getNumericCellValue() + "\t");
                            case BOOLEAN -> System.out.print(cell.getBooleanCellValue() + "\t");
                            default -> System.out.print(" \t");
                        }
                    }
                    System.out.println(); // yangi qatordan
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
